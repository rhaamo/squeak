<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title><%= assigns[:page_title] || "Squeak Â· Index" %></title>

  <link rel="stylesheet" href="<%= Routes.static_path(@conn, "/css/back.css") %>"/>
  <%= csrf_meta_tag() %>
</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <%= link Squeak.States.Config.get(:app_name), to: "/", class: "navbar-brand" %>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item"><%= link "Blog", to: "/blog", class: "nav-link" %></li>
          <li class="nav-item"><%= link "Wiki", to: "/wiki", class: "nav-link" %></li>
          <li class="nav-item"><%= link "About", to: "/about", class: "nav-link" %></li>

          <%= if Pow.Plug.current_user(@conn) do %>
            <%= if Squeak.Users.is_admin?(@current_user) do %>
              <li class="nav-item"><%= link "New Post", to: "/admin/posts/new", class: "nav-link" %></li>
              <li class="nav-item"><%= link "Admin", to: "/admin", class: "nav-link" %></li>
            <% end %>
            <li class="nav-item"><%= link "Sign out", to: Routes.pow_session_path(@conn, :delete), method: :delete, class: "nav-link" %></li>
          <% else %>
            <%= if @registration_enabled do %>
              <li class="nav-item"><%= link "Register", to: Routes.pow_registration_path(@conn, :new), class: "nav-link" %></li>
            <% end %>
            <li class="nav-item"><%= link "Sign in", to: Routes.pow_session_path(@conn, :new), class: "nav-link" %></li>
          <% end %>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Page Content -->
  <div class="container-fluid">

    <div class="row">

      <!-- Blog Entries Column -->
      <div class="content-body col-md-6 offset-md-2">
        <p class="alert alert-info" role="alert"><%= get_flash(@conn, :info) %></p>
        <p class="alert alert-danger" role="alert"><%= get_flash(@conn, :error) %></p>
        <div><%= render @view_module, @view_template, assigns %></div>
      </div>

      <!-- Sidebar Widgets Column -->
      <div class="col-md-2">

        <!-- Side Widget -->
        <div class="card my-4">
          <h5 class="card-header">Administration</h5>
          <div class="card-body">
            <ul class="list-unstyled mb-0">
              <li>
                <%= link "Configuration", to: "/admin/settings" %>
              </li>
            </ul>
            <hr>

            <ul class="list-unstyled mb-0">
              <li>
                <%= link "All posts", to: "/admin/posts" %>
              </li>
            </ul>
          </div>
        </div>

      </div>

    </div>
    <!-- /.row -->

  </div>
  <!-- /.container -->

  <!-- Footer -->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white"><a href="https://github.com/rhaamo/squeak/" target="_blank">squeak squeak!</a></p>
      <%= if Pow.Plug.current_user(@conn) do %>
        <p class="m-0 text-center text-white">Logged in as <%= @current_user.username %> <%= if Squeak.Users.is_admin?(@current_user) do %>(admin)<% else %>(user)<% end %></p>
      <% end %>
    </div>
    <!-- /.container -->
  </footer>

  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/jquery-3.5.1.min.js") %>"></script>
  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/bootstrap.min.js") %>"></script>
  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/moment-with-locales.min.js") %>"></script>
  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/select2.full.min.js") %>"></script>
  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/phoenix.js") %>"></script>
  <%= render_existing @view_module, "scripts.html", assigns %>
</body>

</html>
