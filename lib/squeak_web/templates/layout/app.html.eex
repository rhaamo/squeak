<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title><%= assigns[:page_title] || "Squeak Â· Index" %></title>

  <link rel="stylesheet" href="<%= Routes.static_path(@conn, "/css/front.css") %>"/>
  <%= csrf_meta_tag() %>
</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <%= link Squeak.States.Config.get(:app_name), to: "/", class: "navbar-brand" %>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item"><%= link "Blog", to: "/blog", class: "nav-link" %></li>
          <li class="nav-item"><%= link "Wiki", to: "/wiki", class: "nav-link" %></li>
          <li class="nav-item"><%= link "About", to: "/about", class: "nav-link" %></li>

          <%= if Pow.Plug.current_user(@conn) do %>
            <%= if Squeak.Users.is_admin?(@current_user) do %>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Admin
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <%= link "Admin", to: SqueakWeb.Router.Helpers.admin_path(@conn, :index), class: "dropdown-item" %>
                  <div class="dropdown-divider"></div>
                  <%= link "New Post", to: SqueakWeb.Router.Helpers.admin_post_path(@conn, :new), class: "dropdown-item" %>
                  <div class="dropdown-divider"></div>
                  <%= link "Media manager", to: SqueakWeb.Router.Helpers.admin_media_path(@conn, :new), class: "dropdown-item" %>
                </div>
              </li>
            <% end %>
            <li class="nav-item"><%= link "Sign out", to: Routes.pow_session_path(@conn, :delete), method: :delete, class: "nav-link" %></li>
          <% else %>
            <%= if @registration_enabled do %>
              <li class="nav-item"><%= link "Register", to: Routes.pow_registration_path(@conn, :new), class: "nav-link" %></li>
            <% end %>
            <li class="nav-item"><%= link "Sign in", to: Routes.pow_session_path(@conn, :new), class: "nav-link" %></li>
          <% end %>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Page Content -->
  <div class="container-fluid">

    <div class="row">

      <!-- Blog Entries Column -->
      <div class="content-body col-md-6 offset-md-2">
        <p class="alert alert-info" role="alert"><%= get_flash(@conn, :info) %></p>
        <p class="alert alert-danger" role="alert"><%= get_flash(@conn, :error) %></p>
        <div><%= render @view_module, @view_template, assigns %></div>
      </div>

      <!-- Sidebar Widgets Column -->
      <div class="col-md-2">

        <!-- Search Widget -->
        <div class="card my-4">
          <h5 class="card-header">Search</h5>
          <div class="card-body">
            <form method="get">
              <div class="input-group">
                <input type="text" id="q" name="q" class="form-control" placeholder="Search for...">
                <span class="input-group-btn">
                  <input formaction="<%= SqueakWeb.Router.Helpers.blog_path(@conn, :search) %>" class="btn btn-secondary" type="submit" value="B" title="Search on the blog">
                  <input formaction="" class="btn btn-secondary" type="submit" value="W" title="Search on the wiki">
                </span>
              </div>
            </form>
          </div>
        </div>

        <!-- Fourre tout -->
        <div class="card my-4">
          <h5 class="card-header">Meta</h5>
          <div class="card-body">
            <%= if @conn.private.phoenix_controller == SqueakWeb.BlogController and @conn.private.phoenix_action == :list do %>
              <%= link to: SqueakWeb.Router.Helpers.blog_feed_url(@conn, :list) do %>
                <i title="draft" class="fa fa-feed" aria-hidden="true"></i> Feed URL
              <% end %>
            <% end %>
            <%= if @conn.private.phoenix_controller == SqueakWeb.BlogController and @conn.private.phoenix_action == :list_by_user_slug do %>
              <%= link to: SqueakWeb.Router.Helpers.blog_feed_url(@conn, :list_by_user_slug, @user.slug) do %>
                <i title="draft" class="fa fa-feed" aria-hidden="true"></i> Feed URL
              <% end %>
            <% end %>
            <%= if @conn.private.phoenix_controller == SqueakWeb.BlogController and @conn.private.phoenix_action == :list_by_tag_slug do %>
              <%= link to: SqueakWeb.Router.Helpers.blog_feed_url(@conn, :list_by_tag_slug, @tag.slug) do %>
                <i title="draft" class="fa fa-feed" aria-hidden="true"></i> Feed URL
              <% end %>
            <% end %>
          </div>
        </div>

        <!-- Categories Widget -->
        <div class="card my-4">
          <h5 class="card-header">Categories</h5>
          <div class="card-body">
            <div class="row">
              <div class="col-lg-6">
                <ul class="list-unstyled mb-0">
                  <li>
                    <a href="#">aaa</a>
                  </li>
                  <li>
                    <a href="#">aa</a>
                  </li>
                  <li>
                    <a href="#">aaa</a>
                  </li>
                </ul>
              </div>
              <div class="col-lg-6">
                <ul class="list-unstyled mb-0">
                  <li>
                    <a href="#">a</a>
                  </li>
                  <li>
                    <a href="#">AAAAAA</a>
                  </li>
                  <li>
                    <a href="#">a</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- Side Widget -->
        <div class="card my-4">
          <h5 class="card-header">Tags</h5>
          <div class="card-body">
            <div class="tag_cloud">
              <%= if length(@blog_tags) > 0 do %>
                <%= for tag <- @blog_tags do %>
                  <span class="tag_cloud_item"><%= link tag.name, to: SqueakWeb.Router.Helpers.blog_path(@conn, :list_by_tag_slug, tag.slug) %></span>
                <% end %>
              <% else %>
                No tags.
              <% end %>
            </div>
          </div>
        </div>

      </div>

    </div>
    <!-- /.row -->

  </div>
  <!-- /.container -->

  <!-- Footer -->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white"><a href="https://github.com/rhaamo/squeak/" target="_blank">squeak squeak!</a></p>
      <%= if Pow.Plug.current_user(@conn) do %>
        <p class="m-0 text-center text-white">Logged in as <%= @current_user.username %> <%= if Squeak.Users.is_admin?(@current_user) do %>(admin)<% else %>(user)<% end %></p>
      <% end %>    </div>
    <!-- /.container -->
  </footer>

  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/jquery-3.5.1.min.js") %>"></script>
  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/bootstrap.min.js") %>"></script>
  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/moment-with-locales.min.js") %>"></script>
  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/phoenix.js") %>"></script>
  <script type="text/javascript" src="<%= Routes.static_path(@conn, "/js/vendors/phoenix_html.js") %>"></script>
  <%= render_existing @view_module, "scripts.html", assigns %>
  <%= render_existing @view_module, "#{@conn.private.phoenix_action}_scripts.html", assigns %>
</body>

</html>
